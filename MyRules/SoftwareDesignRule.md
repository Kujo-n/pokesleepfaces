# ウェブアプリ実装時の一般的な設計原則

> 📋 レビュー時は [SoftwareDesignCheckList.md](./SoftwareDesignCheckList.md) を使用してください。

---

## 1. アーキテクチャ原則

### 関心の分離 (Separation of Concerns)
- プレゼンテーション層、ビジネスロジック層、データアクセス層を分離
- 各モジュールは単一の責任を持つ

### DRY (Don't Repeat Yourself)
- コードの重複を避ける
- 共通ロジックはユーティリティ関数やカスタムフックに抽出

### KISS (Keep It Simple, Stupid)
- シンプルな設計を心がける
- 過度な抽象化を避ける

### YAGNI (You Aren't Gonna Need It)
- 現時点で必要のない機能は実装しない
- 将来の要件を過度に予測しない

---

## 2. コンポーネント設計

### 責任と依存の管理
- 単一責任の原則 (SRP): 1つのクラスやコンポーネントは、たった1つの機能・責任に集中させます。
- 依存性逆転の原則 (DIP) / テスト容易性: 具体的な実装ではなく抽象（インターフェース）に依存させ、依存性注入（DI）を活用してテスト可能な設計にします。
- インターフェース分離 (ISP): 利用しないメソッドへの依存を強制せず、インターフェースを最小単位に分割します。

### 構成と再利用性
- コンポジション over 継承: 継承による複雑な階層化を避け、小さな部品を組み合わせる「合成」を優先します。
- 開放閉鎖の原則 (OCP): 既存のコードを修正せず、新しいコードの追加やPropsの拡張によって機能変更に対応できるようにします。
- リスコフの置換原則 (LSP): サブクラスや派生コンポーネントは、親の期待される振る舞いを壊さずに置換可能でなければなりません。

---

## 3. 状態管理

### 最小限の状態
- 本当に必要な状態のみを保持
- 派生データは計算で導出

### 状態の適切な配置
- ローカル状態 vs グローバル状態を適切に判断
- 状態のリフトアップは必要最小限に

### 不変性 (Immutability)
- 状態は直接変更せず、新しいオブジェクトを作成
- 予期しない副作用を防止

---

## 4. パフォーマンス

### 遅延読み込み (Lazy Loading)
- 必要になるまでコンポーネントやデータを読み込まない
- コード分割でバンドルサイズを削減

### メモ化
- 不要な再計算・再レンダリングを防止
- `useMemo`, `useCallback`, `React.memo` の適切な使用

### 画像・アセットの最適化
- 適切なフォーマットとサイズを使用
- 遅延読み込みの実装

---

## 5. セキュリティ

### 入力の検証
- クライアント側とサーバー側の両方で検証
- サニタイズ処理の実装

### 認証・認可
- 適切な認証メカニズムの実装
- 最小権限の原則に従う

### XSS/CSRF対策
- ユーザー入力のエスケープ
- CSRFトークンの使用

---

## 6. アクセシビリティ (a11y)

### セマンティックHTML
- 適切なHTML要素を使用
- ARIA属性の適切な使用

### キーボード操作
- すべての機能がキーボードで操作可能
- フォーカス管理の実装

### コントラストと可読性
- 十分な色のコントラスト
- 読みやすいフォントサイズ

---

## 7. エラーハンドリング

### 優雅な劣化 (Graceful Degradation)
- エラー時も可能な限り機能を維持
- ユーザーフレンドリーなエラーメッセージ

### エラー境界
- エラーの伝播を防止
- フォールバックUIの提供

### ログとモニタリング
- 適切なエラーログの記録
- 問題の早期発見と対応

---

## 8. テスタビリティ

### テスト可能な設計
- 依存性注入の活用
- 副作用の分離

### テストの種類
- ユニットテスト
- 統合テスト
- E2Eテスト

---

## 9. コードの品質

### 一貫したコーディングスタイル
- ESLint/Prettierの設定
- 命名規則の統一

### ドキュメント
- 適切なコメント
- README、APIドキュメントの整備

### バージョン管理
- 意味のあるコミットメッセージ
- 適切なブランチ戦略

---

## 10. スケーラビリティ

### モジュラー設計
- 機能ごとにモジュール化
- 疎結合を維持

### API設計
- RESTful または GraphQL の原則に従う
- バージョニングの考慮

### キャッシュ戦略
- 適切なキャッシュの実装
- 無効化戦略の設計